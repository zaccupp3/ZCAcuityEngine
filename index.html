<!-- Saved: Dec 3, 2025 -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Cupp Health Solutions – Assignment Engine</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- Top Header / Nav -->
  <header class="app-header">
    <div class="header-left">
      <span class="logo-dot"></span>
      <span class="header-title">
        Cupp Health Solutions: Assignment Engine - Created by Zachary Cupp, BSN, RN
      </span>
    </div>
    <div class="header-right">
      <button class="header-link">Log In</button>
      <button class="header-cta">Get Care</button>
    </div>
  </header>

  <!-- Tab Bar -->
  <nav class="tab-bar">
    <button class="tabButton active" data-target="staffingTab" onclick="showTab('staffingTab', this)">
      Staffing Details
    </button>
    <button class="tabButton" data-target="patientDetailsTab" onclick="showTab('patientDetailsTab', this)">
      Patient Details
    </button>
    <button class="tabButton" data-target="highRiskTab" onclick="showTab('highRiskTab', this)">
      High Risk Report
    </button>
    <button class="tabButton" data-target="liveAssignmentTab" onclick="showTab('liveAssignmentTab', this)">
      LIVE Assignment
    </button>
    <button class="tabButton" data-target="oncomingAssignmentTab" onclick="showTab('oncomingAssignmentTab', this)">
      Oncoming Assignment
    </button>
  </nav>

  <!-- MAIN CONTENT -->
  <main class="main-container">

    <!-- STAFFING TAB -->
    <section id="staffingTab" class="tab-section" style="display: block;">
      <h1>Staffing Details</h1>

      <div class="staffing-two-column">
        <!-- Current Shift Column -->
        <div class="staff-column">
          <h2>Current Shift</h2>

          <div class="staff-card">
            <div class="staff-card-header">Current RNs</div>
            <div class="staff-inline-controls">
              <label for="currentNurseCount">Current RNs:</label>
              <select id="currentNurseCount">
                <option>1</option><option>2</option><option>3</option><option>4</option>
                <option>5</option><option>6</option><option>7</option><option>8</option>
              </select>
              <button onclick="setupCurrentNurses()">Update Current RNs</button>
            </div>
            <div class="staff-subtitle">Current RN List</div>
            <div id="currentNurseList" class="staffList"></div>
          </div>

          <div class="staff-card">
            <div class="staff-card-header">Current PCAs</div>
            <div class="staff-inline-controls">
              <label for="pcaShift">PCA Shift:</label>
              <select id="pcaShift" onchange="updatePcaShift(this.value)">
                <option value="day">Day</option>
                <option value="night">Night</option>
              </select>

              <span>Current PCAs:</span>
              <select id="currentPcaCount">
                <option>1</option><option>2</option><option>3</option>
                <option>4</option><option>5</option><option>6</option>
              </select>
              <button onclick="setupCurrentPcas()">Update Current PCAs</button>
            </div>
            <div class="staff-subtitle">Current PCA List</div>
            <div id="currentPcaList" class="staffList"></div>
          </div>
        </div>

        <!-- Oncoming Shift Column -->
        <div class="staff-column">
          <h2>Oncoming Shift</h2>

          <div class="staff-card">
            <div class="staff-card-header">Oncoming RNs</div>
            <div class="staff-inline-controls">
              <label for="incomingNurseCount">Oncoming RNs:</label>
              <select id="incomingNurseCount">
                <option>1</option><option>2</option><option>3</option><option>4</option>
                <option>5</option><option>6</option><option>7</option><option>8</option>
              </select>
              <button onclick="setupIncomingNurses()">Update Oncoming RNs</button>
            </div>
            <div class="staff-subtitle">Oncoming RN List</div>
            <div id="incomingNurseList" class="staffList"></div>
          </div>

          <div class="staff-card">
            <div class="staff-card-header">Oncoming PCAs</div>
            <div class="staff-inline-controls">
              <label for="incomingPcaCount">Oncoming PCAs:</label>
              <select id="incomingPcaCount">
                <option>1</option><option>2</option><option>3</option>
                <option>4</option><option>5</option><option>6</option>
              </select>
              <button onclick="setupIncomingPcas()">Update Oncoming PCAs</button>
            </div>
            <div class="staff-subtitle">Oncoming PCA List</div>
            <div id="incomingPcaList" class="staffList"></div>
          </div>
        </div>
      </div>
    </section>

    <!-- PATIENT DETAILS TAB -->
    <section id="patientDetailsTab" class="tab-section" style="display: none;">
      <h1>Patient Details</h1>
      <p>
        This grid shows all 32 rooms. Use the controls to set acuity tags and gender
        for each patient. These tags feed both the LIVE and Oncoming Assignment engines.
      </p>

      <div class="actions-row">
        <button onclick="renderPatientList()">Refresh Patient Grid</button>
        <button onclick="resetAllPatients()">Reset All Patients</button>
      </div>

      <div id="patientList" class="patient-grid"></div>
    </section>

    <!-- HIGH RISK TAB -->
    <section id="highRiskTab" class="tab-section" style="display: none;">
      <h1>High Risk Report</h1>
      <p>
        Summary of key acuity tags across all active patients. Use this for quick
        situational awareness and handoff.
      </p>

      <div class="actions-row">
        <button onclick="updateAcuityTiles()">Refresh High Risk Report</button>
        <button onclick="openAcuityModal()">Open Full Acuity Modal</button>
      </div>

      <div id="acuityTiles" class="acuity-tiles-container"></div>
    </section>

    <!-- LIVE ASSIGNMENT TAB -->
    <section id="liveAssignmentTab" class="tab-section" style="display: none;">
      <h1>Live Assignment</h1>

      <div class="actions-row">
        <button onclick="window.populateLiveAssignment(false)">Populate Live Assignment</button>
        <button onclick="window.populateLiveAssignment(true)">Randomize Live Assignment</button>
        <button onclick="clearRecentlyDischargedFlags()">Clear “Recently Discharged” Flags</button>
      </div>

      <div class="live-top-bar">
        <div class="discharge-bin">
          <strong>Discharge Bin:</strong>
          <span id="dischargeCount">0</span> recent this session
          <button onclick="openDischargeHistoryModal()">View History</button>
          <div
            id="dischargeDropZone"
            class="discharge-drop-zone"
            ondragover="onDischargeDragOver(event)"
            ondrop="onDischargeDrop(event)"
          >
            Drag here to discharge patient
          </div>
        </div>
      </div>

      <div class="live-layout">
        <div class="live-column">
          <h2>Current RN Assignments</h2>
          <div id="liveNurseAssignments" class="assignment-grid"></div>
        </div>
        <div class="live-column">
          <h2>Current PCA Assignments</h2>
          <div id="livePcaAssignments" class="assignment-grid"></div>

          <h2 style="margin-top: 24px;">Admit Queue</h2>

          <div class="actions-row">
            <button onclick="promptAddAdmit()">+ Add Admit</button>
          </div>

          <div id="queueList" class="queue-list"></div>

        </div>
      </div>
    </section>

    <!-- ONCOMING ASSIGNMENT TAB -->
    <section id="oncomingAssignmentTab" class="tab-section" style="display: none;">
      <h1>Oncoming Assignment (Incoming Staff)</h1>

      <div class="actions-row">
        <button onclick="populateOncomingAssignment()">Populate Oncoming Assignment</button>
        <button onclick="rebalanceOncomingAssignment()">Re-generate / Rebalance</button>
      </div>

      <h2>Incoming RN Assignments</h2>
      <div id="assignmentOutput" class="assignment-grid two-column-grid"></div>

      <h2 style="margin-top: 24px;">Incoming PCA Assignments</h2>
      <div id="pcaAssignmentOutput" class="assignment-grid two-column-grid"></div>
    </section>
  </main>

  <!-- MODALS (same as before) -->
  <div id="patientProfileModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <span id="profileModalTitle">Patient Profile</span>
        <button class="close-btn" onclick="closePatientProfileModal()">&times;</button>
      </div>
      <div class="modal-body">
        <div class="modal-row">
          <label for="profGender"><strong>Gender:</strong></label>
          <select id="profGender">
            <option value="">-</option>
            <option value="F">F</option>
            <option value="M">M</option>
            <option value="X">X</option>
          </select>
        </div>

        <div class="modal-grid">
          <div class="modal-column">
            <h3>RN Acuity Tags</h3>
            <label><input type="checkbox" id="profTele" /> Tele</label>
            <label><input type="checkbox" id="profDrip" /> Drip</label>
            <label><input type="checkbox" id="profNih" /> NIH</label>
            <label><input type="checkbox" id="profBg" /> BG</label>
            <label><input type="checkbox" id="profCiwa" /> CIWA/COWS</label>
            <label><input type="checkbox" id="profRestraint" /> Restraint</label>
            <label><input type="checkbox" id="profSitter" /> Sitter</label>
            <label><input type="checkbox" id="profVpo" /> VPO</label>
            <label><input type="checkbox" id="profIso" /> Isolation</label>
            <label><input type="checkbox" id="profAdmit" /> Admit</label>
            <label><input type="checkbox" id="profLateDc" /> Late DC</label>
          </div>

          <div class="modal-column">
            <h3>PCA Acuity Tags</h3>
            <label><input type="checkbox" id="profTelePca" /> Tele</label>
            <label><input type="checkbox" id="profIsoPca" /> Isolation</label>
            <label><input type="checkbox" id="profAdmitPca" /> Admit</label>
            <label><input type="checkbox" id="profLateDcPca" /> Late DC</label>
            <label><input type="checkbox" id="profChg" /> CHG</label>
            <label><input type="checkbox" id="profFoley" /> Foley</label>
            <label><input type="checkbox" id="profQ2" /> Q2 Turns</label>
            <label><input type="checkbox" id="profHeavy" /> Heavy</label>
            <label><input type="checkbox" id="profFeeder" /> Feeder</label>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button onclick="savePatientProfile()">Save</button>
        <button onclick="closePatientProfileModal()">Cancel</button>
      </div>
    </div>
  </div>

  <div id="dischargeHistoryModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <span>Discharge History (This Session)</span>
        <button class="close-btn" onclick="closeDischargeHistoryModal()">&times;</button>
      </div>
      <div class="modal-body" id="dischargeHistoryBody"></div>
    </div>
  </div>

  <div id="acuityModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <span>High Acuity Summary</span>
        <button class="close-btn" onclick="closeAcuityModal()">&times;</button>
      </div>
      <div class="modal-body" id="acuityReportBody"></div>
    </div>
  </div>

  <!-- ASSIGN ADMIT MODAL -->
  <div id="queueAssignModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <span>Assign Admit to RN / PCA</span>
        <button class="close-btn" onclick="closeQueueAssignModal()">&times;</button>
      </div>

      <div class="modal-body">
        <p id="queueAssignInfo" style="margin-bottom: 12px; font-size: 14px; opacity: 0.8;">
          Select the receiving RN, PCA, and the empty bed for this admit.
        </p>

        <div class="modal-row">
          <label for="queueAssignBed"><strong>Receiving Bed (Empty):</strong></label>
          <select id="queueAssignBed"></select>
        </div>

        <div class="modal-row">
          <label for="queueAssignNurse"><strong>Receiving RN:</strong></label>
          <select id="queueAssignNurse"></select>
        </div>

        <div class="modal-row">
          <label for="queueAssignPca"><strong>Receiving PCA:</strong></label>
          <select id="queueAssignPca"></select>
        </div>

        <p style="font-size: 12px; opacity: 0.7; margin-top: 8px;">
          Tip: if you don’t see the bed you expect, make sure the room is marked empty in Patient Details or by discharge.
        </p>
      </div>

      <div class="modal-footer">
        <button onclick="confirmQueueAssign()">Assign</button>
        <button onclick="closeQueueAssignModal()">Cancel</button>
      </div>
    </div>
  </div>

  <script src="app/app.state.js"></script>
  <script src="app/app.staffing.js"></script>
  <script src="app/app.patientsAcuity.js"></script>
  <script src="app/app.assignmentsDrag.js"></script>
  <script src="app/app.assignmentRules.js"></script>

  <!-- THESE MUST COME BEFORE INIT -->
  <script src="app/app.liveAssignments.js"></script>
  <script src="app/app.assignmentsrender.js"></script>
  <script src="app/app.modals.js"></script>

  <script src="app/app.init.js"></script>
  <script src="script.js"></script>
</body>
</html>
